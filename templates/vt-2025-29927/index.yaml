id: vt-2025-29927

info:
  name: "Next.js Middleware Bypass"
  author: omarkurt
  description: |
    Next.js contains a critical middleware bypass vulnerability affecting versions 11.1.4 through 15.2.2.
    The vulnerability allows attackers to bypass middleware security controls by sending a specially crafted
    'x-middleware-subrequest' header, which can lead to authorization bypass and other security control circumvention.
  targets:
    - "web-application"
  type: CVE
  affected_versions:
    - "11.1.4"
  fixed_version: "15.2.3"
  cve: "CVE-2025-29927"
  cwe: "CWE-287"
  cvss:
    score: "9.1"
    metrics: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N"
  tags:
    - "nextjs"
    - "middleware"
    - "auth-bypass"

references:
  - https://zhero-web-sec.github.io/research-and-things/nextjs-and-the-corrupt-middleware
  - https://github.com/vercel/next.js/security/advisories/GHSA-f82v-jwr5-mffw
  - https://slcyber.io/assetnote-security-research-center/doing-the-due-diligence-analysing-the-next-js-middleware-bypass-cve-2025-29927/
  - https://github.com/projectdiscovery/nuclei-templates-labs/tree/main/http/cves/2025/CVE-2025-29927
  - https://vulnerabletarget.com/VT-2025-29927

poc:
  nuclei:
    - "vt-2025-29927.nuclei.yaml"

remediation:
  - "Upgrade to Next.js 14.2.25 or 15.2.3 or later. If upgrading is not possible"
  - "block the x-middleware-subrequest header at the WAF or server level."

providers:
  docker-compose:
    path: "docker-compose.yaml"

post-install:
  - "http://localhost:3000"
